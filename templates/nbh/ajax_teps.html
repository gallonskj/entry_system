{% extends 'templates/index.html' %}
{% load static %}
{% load SelfDefinedFilter%}
{% block title %}快感体验能力量表{% endblock %}
{% block css %}
    <link href="{% static '/css/scales_style.css' %}" rel="stylesheet" >
{% endblock %}
{% block content %}
    <div class="right_col" role="main" >
        <div class="container">
            <div class="row show-grid">
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <ul class="breadcrumb" style="background-color: white;font-weight:bold">
                         <li >量表录入</li>
                         <li>自评量表</li>
						 <li class="active">快感体验能力量表</li>
						 <div style="float: right;margin-bottom: 0;"></div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="dashboard_graph x_panel" style="margin-top: 0;height:80%;">
			<div class="row"  style="margin-left:5px;margin-top: 5px;padding-bottom: 5px;">
				<div align="center" style="padding-left: 22.5%; padding-right: 22.5%">
					<h5>
						<strong>
							<i class="fa fa-hand-o-down"></i>&nbsp;
							<i class="fa fa-hand-o-down"></i>&nbsp;
							<i class="fa fa-hand-o-down"></i>&nbsp;
							指导语：该量表用于测试您在最近数日能体会快乐的能力过的项目时，请仔细阅读每个项目，然后根据您的情况选择最适合的答案。
						</strong>
					</h5>
				</div>
			</div>
            <div class="question_area" name="question_area" style="text-align: center">
                <form id="question_form" name="question_form" action="#">
					{% csrf_token %}
                    <h3><div name="question_test" id="question_test" class="row">1.当我得知我最喜欢演员的新片上映时，我非常渴望立刻看到。</div></h3>
                    <div class="options" style=" text-align: left;padding-left: 47.5%">
                        <div class="row show-grid" style="margin:10px">
                            <label>
                                <input type="radio" name="answer" value=1 data-labelauty="&nbsp;&nbsp;完全不符合" />
                            </label>
                        </div>
						<div class="row show-grid" style="margin:10px">
							<label>
                                <input type="radio" name="answer" value=2 data-labelauty="&nbsp;&nbsp;&nbsp;&nbsp;不符合&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"/>
							</label>
						</div>
                        <div class="row show-grid" style="margin:10px">
							<label>
                                <input type="radio" name="answer" value=3 data-labelauty="&nbsp;&nbsp;基本不符合" />
							</label>
						</div>
						<div class="row show-grid" style="margin:10px">
							<label>
                                <input type="radio" name="answer" value=4 data-labelauty="&nbsp;&nbsp;基本符合&nbsp;&nbsp;&nbsp;"/>
							</label>
						</div>
                        <div class="row show-grid" style="margin:10px">
							<label>
                                <input type="radio" name="answer" value=5 data-labelauty="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;符合&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"/>
							</label>
						</div>
                        <div class="row show-grid" style="margin:10px">
							<label>
                                <input type="radio" name="answer" value=6 data-labelauty="&nbsp;&nbsp;完全符合&nbsp;&nbsp;&nbsp;"/>
							</label>
						</div>
                    </div>
                    <div>
                        <input id="question_submit" type="button" class="btn btn-success text-center" style="width:68px;height:34px" value="下一题">
                        <input type="button" class="btn btn-warning text-center" style="width:68px;height:34px" value="退&nbsp;&nbsp;出">
                    </div>
                </form>
            </div>
    </div>
{% endblock %}

{% block js %}
<script type="text/javascript" src="{% static '/js/jquery-radio-beauty.js'%}"></script>
<script>
	let time = new Date();
	let suicide = false;
    let question_index = 1;
	$(document).ready(function(){
		$("input[type='radio']").labelauty();

		$("#question_submit").on('click', function(){
			if (document.question_form.answer.value==="") {
                alert("问题不能为空！");
			}else{
				ajax_post($('#question_form'));
                update_question(question_index);
                question_index ++;
			}
		});
	});

	function get_duration(){
		const current_time = new Date();
		const duration = time - current_time;
		time = current_time;
		return -duration;
	}

	function update_question(index){
	    switch (index) {
            case 2:
                document.getElementById('question_test').innerHTML="2.当我外出散步时，我很享受深呼吸新鲜空气的感觉";break;
            case 3:
                document.getElementById('question_test').innerHTML="3.新割过草坪的气息让我感到享受";break;
            case 4:
                document.getElementById('question_test').innerHTML="4.在我的生活中，我渴求很多东西";break;
            case 5:
                document.getElementById('question_test').innerHTML="5.我很喜欢长辈抚摸我的头发";break;
            case 6:
                document.getElementById('question_test').innerHTML="6.追求许多愉快事情本身对我来说也是一种快乐";break;
            case 7:
                document.getElementById('question_test').innerHTML="7.寒冷早上一杯热咖啡或茶对我是大大的满足";break;
            case 8:
                document.getElementById('question_test').innerHTML="8.当我想到美味的东西，比如巧克力饼干时，我非得给自己来上一块";break;
            case 9:
                document.getElementById('question_test').innerHTML="9.我喜欢欣赏初雪的美景";break;
            case 10:
                document.getElementById('question_test').innerHTML="10.重大节日前的夜晚，我常常兴奋得无法入眠";break;
            case 11:
                document.getElementById('question_test').innerHTML="11.在去游乐园的路上，我就迫不及待的想去乘坐过山车";break;
            case 12:
                document.getElementById('question_test').innerHTML="12.一个大哈欠会让我浑身舒坦";break;
            case 13:
                document.getElementById('question_test').innerHTML="13.我对在外面餐馆吃饭之类的事情并没什么期待的";break;
            case 14:
                document.getElementById('question_test').innerHTML="14.躺在温暖的床上，我喜欢倾听外面的雨声";break;
            case 15:
                document.getElementById('question_test').innerHTML="15.品尝美食的场景进入脑海时，我几乎都能尝到它的美味";break;
            case 16:
                document.getElementById('question_test').innerHTML="16.点完菜后，我就会想象接下来的美味";break;
            case 17:
                document.getElementById('question_test').innerHTML="17.炉子上烹饪食物的声音让我感觉舒坦";break;
            case 18:
                document.getElementById('question_test').innerHTML="18.当一些令人兴奋的事情即将出现在生活中时，我由衷的期待";break;
        }
    }

	function ajax_post(form){
		const csrf = $('input[name="csrfmiddlewaretoken"]').val();
		$.ajax({
		url: 'http://127.0.0.1:8000/scales/test_submit',
		type: 'POST',
		dataType: 'JSON',
		async:true,
		data: {'data':form.serialize(),
            'question_index': question_index,
			'duration':get_duration(),
			'csrfmiddlewaretoken': csrf
			}
		})
	}

</script>

{% endblock %}